apply plugin: rootProject.ext.plugins.application
//添加 com.sensorsdata.analytics.android 插件
apply plugin: 'com.sensorsdata.analytics.android'
apply from: "../../node_modules/react-native-code-push/android/codepush.gradle"

project.ext.react = [
        entryFile   : "index.js",
        enableHermes: false  // clean and rebuild if changing
]

apply from: "../../node_modules/react-native/react.gradle"


def enableHermes = project.ext.react.get("enableHermes", false)
def enableSeparateBuildPerCPUArchitecture = false
def jscFlavor = 'org.webkit:android-jsc:+'

android {
    compileSdkVersion rootProject.ext.android.compileSdkVersion
    buildToolsVersion rootProject.ext.android.buildToolsVersion
    aaptOptions.cruncherEnabled = false
    aaptOptions.useNewCruncher = false
    defaultConfig {
        multiDexEnabled true
        applicationId rootProject.ext.android.applicationId
        minSdkVersion rootProject.ext.android.minSdkVersion
        targetSdkVersion rootProject.ext.android.targetSdkVersion
        versionCode 2102
        versionName "2.1.2"
        ndk {
            abiFilters "armeabi-v7a", "x86"
        }
        javaCompileOptions {
            annotationProcessorOptions { includeCompileClasspath = true }
        }
    }
    dexOptions {
        jumboMode true
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    lintOptions {
        checkReleaseBuilds false
        abortOnError false
        disable 'GoogleAppIndexingWarning'
    }
    splits {
        abi {
            reset()
            enable enableSeparateBuildPerCPUArchitecture
            universalApk false  // If true, also generate a universal APK
            include "armeabi-v7a", "x86"
        }
    }
    packagingOptions {
        pickFirst '**/armeabi-v7a/libc++_shared.so'
        pickFirst '**/x86/libc++_shared.so'
        pickFirst '**/arm64-v8a/libc++_shared.so'
        pickFirst '**/x86_64/libc++_shared.so'
        pickFirst '**/x86/libjsc.so'
        pickFirst '**/armeabi-v7a/libjsc.so'
    }
    sourceSets {
        main {
            jniLibs.srcDirs = ['libs']
        }
    }
    signingConfigs {
        release {
            keyAlias KEY_ALIAS
            keyPassword KEY_PASSWORD
            storeFile file(STORE_FILE)
            storePassword KEYSTORE_PASSWORD
        }
        releaseStaging {
            keyAlias KEY_ALIAS
            keyPassword KEY_PASSWORD
            storeFile file(STORE_FILE)
            storePassword KEYSTORE_PASSWORD
        }
        debug {
            keyAlias KEY_ALIAS
            keyPassword KEY_PASSWORD
            storeFile file(STORE_FILE)
            storePassword KEYSTORE_PASSWORD
        }
    }
    buildTypes {
        debug {
            signingConfig signingConfigs.release
            buildConfigField "String", "CODEPUSH_KEY", '""'
            manifestPlaceholders = [
                    JPUSH_PKGNAME : "com.meeruu.sharegoods",
                    // 开发环境
                    JPUSH_APPKEY  : "3288c3f3feb6c119e3d88049",
                    // 生产环境
//                    JPUSH_APPKEY  : "7fde54543daf045a209a7abf",
                    JPUSH_CHANNEL : "guanwang", //暂时填写默认值即可.
                    XIAOMI_APPKEY : "",//小米平台注册的appkey
                    XIAOMI_APPID  : "",//小米平台注册的appid
                    HUAWEI_APPID  : "",//华为平台注册的appid
                    MEIZU_APPKEY  : "",//魅族平台注册的appkey
                    MEIZU_APPID   : "",//魅族平台注册的appid
                    OPPO_APPKEY   : "", // OPPO平台注册的appkey
                    OPPO_APPID    : "", // OPPO平台注册的appid
                    OPPO_APPSECRET: "",//OPPO平台注册的appsecret
                    //                VIVO_APPKEY  : "您的应用对应的vivo的AppKey", // VIVO平台注册的appkey
                    //                VIVO_APPID   : "您的应用对应的vivo的AppID", // VIVO平台注册的appid
            ]
        }
        releaseStaging {
            minifyEnabled true
            shrinkResources true
            zipAlignEnabled true
            signingConfig signingConfigs.release
            buildConfigField "String", "CODEPUSH_KEY", '"mkJ7arPkmEFxQcosZQh1EQwsIl2N4ksvOXqog"'
            manifestPlaceholders = [
                    JPUSH_PKGNAME : "com.meeruu.sharegoods",
                    // 生产环境
                    JPUSH_APPKEY  : "7fde54543daf045a209a7abf",
                    JPUSH_CHANNEL : "guanwang", //暂时填写默认值即可.
                    XIAOMI_APPKEY : "MI-5841792166549",//小米平台注册的appkey
                    XIAOMI_APPID  : "MI-2882303761517921549",//小米平台注册的appid
                    HUAWEI_APPID  : "100536409",//华为平台注册的appid
                    MEIZU_APPKEY  : "MZ-207d98bc8f6344398268cad84ce07355",//魅族平台注册的appkey
                    MEIZU_APPID   : "MZ-120154",//魅族平台注册的appid
                    OPPO_APPKEY   : "OP-47aa3cbd552a49c6baf2c3289e69b07b", // OPPO平台注册的appkey
                    OPPO_APPID    : "OP-3730052", // OPPO平台注册的appid
                    OPPO_APPSECRET: "OP-b7f0edbb073b40b493714a996a6db099",//OPPO平台注册的appsecret
                    //                VIVO_APPKEY  : "您的应用对应的vivo的AppKey", // VIVO平台注册的appkey
                    //                VIVO_APPID   : "您的应用对应的vivo的AppID", // VIVO平台注册的appid
            ]
        }
        release {
            minifyEnabled true
            shrinkResources true
            zipAlignEnabled true
            signingConfig signingConfigs.release
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            buildConfigField "String", "CODEPUSH_KEY", '"oINKVk36QLNtFykLGUBp6XL9VYJx4ksvOXqog"'
            manifestPlaceholders = [
                    JPUSH_PKGNAME : "com.meeruu.sharegoods",
                    // 生产环境
                    JPUSH_APPKEY  : "7fde54543daf045a209a7abf",
                    JPUSH_CHANNEL : "guanwang", //暂时填写默认值即可.
                    XIAOMI_APPKEY : "MI-5841792166549",//小米平台注册的appkey
                    XIAOMI_APPID  : "MI-2882303761517921549",//小米平台注册的appid
                    HUAWEI_APPID  : "100536409",//华为平台注册的appid
                    MEIZU_APPKEY  : "MZ-207d98bc8f6344398268cad84ce07355",//魅族平台注册的appkey
                    MEIZU_APPID   : "MZ-120154",//魅族平台注册的appid
                    OPPO_APPKEY   : "OP-47aa3cbd552a49c6baf2c3289e69b07b", // OPPO平台注册的appkey
                    OPPO_APPID    : "OP-3730052", // OPPO平台注册的appid
                    OPPO_APPSECRET: "OP-b7f0edbb073b40b493714a996a6db099",//OPPO平台注册的appsecret
                    //                VIVO_APPKEY  : "您的应用对应的vivo的AppKey", // VIVO平台注册的appkey
                    //                VIVO_APPID   : "您的应用对应的vivo的AppID", // VIVO平台注册的appid
            ]
        }
    }

    repositories {
        maven {
            url "http://maven.aliyun.com/nexus/content/repositories/releases"
        }
        flatDir {
            dirs 'libs'
        }
    }
}

sensorsAnalytics {
    exclude = ['com.qiyukf']
}

dependencies {
    api fileTree(include: ['*.jar'], dir: 'libs')

    if (enableHermes) {
        def hermesPath = "../../node_modules/hermesvm/android/"
        debugImplementation files(hermesPath + "hermes-debug.aar")
        releaseImplementation files(hermesPath + "hermes-release.aar")
        releaseStagingImplementation files(hermesPath + "hermes-release.aar")
    } else {
        implementation jscFlavor
    }

    api rootProject.ext.dependencies.eventbus
    api rootProject.ext.dependencies.zxing
    api rootProject.ext.dependencies.wechat
    api rootProject.ext.dependencies.lottie
    api rootProject.ext.dependencies.webp
    api rootProject.ext.dependencies.webpAnimated

    api(name: 'alipaySdk-15.5.9-20181123210657-noUtdid', ext: 'aar')
    api project(':@mr_react-native-video')
    api project(':react-native-linear-gradient')
    api project(':react-native-fetch-blob')
    api project(':@react-native-community_netinfo')
    api project(':@react-native-community_slider')
    api project(':commonlib')
    api project(':qrcode')
    api project(':rn_deviceinfo')
    api project(':base_adapter')
    api project(':react-native-extra-dimensions-android')
    api project(':react-native-code-push')
    implementation project(':react-native-gesture-handler')
    implementation project(':@mr_mr-rn-storage')
    implementation project(':@mr_rn-request')
    implementation project(':@mr_rn-geolocation')
    implementation project(':@mr_cookies')
    implementation project(':rn_imagecrop')
    api rootProject.ext.dependencies.sensors

    implementation 'com.aliyun.video.android:svideosnap:3.10.5'//短视频基础版SDK必须依赖
    implementation 'com.aliyun.video.android:core:1.2.0' //核心库必须依赖
    implementation 'com.alivc.conan:AlivcConan:0.9.5'//核心库必须依赖
    implementation 'com.aliyun.video.android:AlivcSvideoFFmpeg:1.0.1'//必须依赖
    implementation 'com.aliyun.video.android:upload:1.5.2'// 上传库,如不需要上传可不依赖
    implementation 'com.google.code.gson:gson:2.8.2'
    implementation 'com.aliyun.video.android:upload:1.5.2'
    implementation 'com.aliyun.dpa:oss-android-sdk:+'

}
